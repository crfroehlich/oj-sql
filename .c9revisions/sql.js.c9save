{"ts":1363395659334,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1363401035241,"patch":[[{"diffs":[[1,"function each(obj, onSuccess, recursive) {\r\n    if (obj) {\r\n        Object.keys(obj).forEach(function(key) {\r\n            var val = obj[key];\r\n            if (onSuccess) {\r\n                var quit = onSuccess(val);\r\n                if (false === quit) {\r\n                    return false;\r\n                }\r\n            }\r\n            if (true === recursive) {\r\n                each(val, onSuccess, true);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n\r\nfunction curryLeft(func) {\r\n   var slice = Array.prototype.slice;\r\n   var args = slice.call(arguments, 1);\r\n   return function() {\r\n       return func.apply(this, args.concat(args, slice.call(arguments, 0)));\r\n\r\n   }\r\n}\r\n\r\nfunction foldLeft(func,newArray,oldArray) {\r\n    var accumulation = newArray;\r\n    each(oldArray, function(val) {\r\n        accumulation = func(accumulation, val);\r\n    });\r\n    return accumulation;\r\n    \r\n}\r\n\r\nfunction map(func, array) {\r\n    var onIteration = function(accumulation, val) {\r\n        return accumulation.concat(func(val));\r\n    };\r\n    return foldLeft(onIteration, [], array)\r\n}\r\n\r\nfunction filter(func, array) {\r\n    var onIteration = function(accumulation, val) {\r\n        if(func(val)) {\r\n            return accumulation.concat(val);\r\n        } else {\r\n            return accumulation;\r\n        }\r\n    };\r\n    return foldLeft(onIteration, [], array)\r\n}\r\n\r\nArray.prototype._where = function(func) { return filter(func, this); }\r\nArray.prototype._select = function(func) { return map(func, this); }\r\n\r\nfunction select() {\r\n    var array = this;\r\n    var slice = Array.prototype.slice;\r\n    var args = slice.call(arguments, 0);\r\n    var cols = [];\r\n    each(args, function(argumentValue) {\r\n        cols.push(array._select(function(val) { return val[argumentValue]; }));\r\n    });\r\n    var ret = [];\r\n    if(cols.length === args.length && cols.length > 0) {\r\n        var col = cols[0];\r\n        \r\n        for(var r=0; r < col.length; r += 1) {\r\n            var thisRow = ret[r] || {};\r\n            for(var c=0; c < cols.length; c += 1) {\r\n                thisRow[args[c]] = cols[c][r];\r\n            }\r\n            ret.push(thisRow);\r\n        }\r\n    }\r\n    \r\n    return ret;\r\n    \r\n}\r\nArray.prototype.select = select;\r\n\r\nfunction from(array) {\r\n    return array;\r\n}\r\n\r\n\r\nvar peoples = [\r\n    { FirstName : \"John\", LastName : \"Doe\", Age : 29 },\r\n    { FirstName : \"Jane\", LastName : \"Doe\", Age : 33 },\r\n    { FirstName : \"Mary\", LastName : \"White\", Age : 31 },\r\n    { FirstName : \"Barry\", LastName : \"White\", Age : 31 },\r\n    { FirstName : \"Kevin\", LastName : \"Black\", Age : 31 },\r\n    { FirstName : \"Anna\", LastName : \"Smith\", Age : 1 }\r\n    \r\n];\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":2638}]],"length":2638,"saved":false}
{"contributors":[],"silentsave":false,"ts":1363459010614,"patch":[[{"diffs":[[1,"/* global makeClass:true */\r\n\r\n"],[0,"function each(ob"]],"start1":0,"start2":0,"length1":16,"length2":47},{"diffs":[[0,"}\r\n}\r\n\r\n"],[1,"var sqlArray = makeClass('sqlArray', Array, function callBack() {});\r\n\r\nfunction makeArray(val) {\r\n    return new sqlArray(val);\r\n}\r\n"],[0,"\r\nfuncti"]],"start1":472,"start2":472,"length1":16,"length2":149},{"diffs":[[0,"\n   var slice = "],[1,"sql"],[0,"Array.prototype."]],"start1":642,"start2":642,"length1":32,"length2":35},{"diffs":[[0,"ft(onIteration, "],[-1,"[]"],[1,"makeArray()"],[0,", array)\r\n}\r\n\r\nf"]],"start1":1206,"start2":1206,"length1":34,"length2":43},{"diffs":[[0,"ration, "],[-1,"[]"],[1,"makeArray()"],[0,", array)"]],"start1":1500,"start2":1500,"length1":18,"length2":27},{"diffs":[[0,")\r\n}\r\n\r\n"],[1,"sql"],[0,"Array.pr"]],"start1":1526,"start2":1526,"length1":16,"length2":19},{"diffs":[[0,"is); }\r\n"],[1,"sql"],[0,"Array.pr"]],"start1":1601,"start2":1601,"length1":16,"length2":19},{"diffs":[[0," cols = "],[-1,"[]"],[1,"makeArray()"],[0,";\r\n    e"]],"start1":1817,"start2":1817,"length1":18,"length2":27},{"diffs":[[0,"t = "],[-1,"[]"],[1,"makeArray()"],[0,";\r\n "]],"start1":1981,"start2":1981,"length1":10,"length2":19},{"diffs":[[0,"   \r\n}\r\n"],[-1,""],[0,""],[1,"sql"],[0,"Array.pr"]],"start1":2374,"start2":2374,"length1":16,"length2":19},{"diffs":[[0,"oples = "],[-1,""],[0,""],[1,"makeArray("],[0,"[\r\n    {"]],"start1":2477,"start2":2477,"length1":16,"length2":26},{"diffs":[[0,"\n    \r\n]"],[-1,""],[0,""],[1,")"],[0,";\r\n\r\n"]],"start1":2847,"start2":2847,"length1":13,"length2":14}]],"length":2861,"saved":false}
{"contributors":[],"silentsave":false,"ts":1363478153718,"patch":[[{"diffs":[[0,"nSuccess(val"],[-1,""],[0,""],[1,", key"],[0,");\r\n        "]],"start1":232,"start2":232,"length1":24,"length2":29},{"diffs":[[0,"ue === recursive"],[1," && (typeof val === 'object' || typeof val === 'array')"],[0,") {\r\n           "]],"start1":379,"start2":379,"length1":32,"length2":87},{"diffs":[[0,"\r\n\r\n"],[-1,"var sqlArray = makeClass('sqlArray', Array, function callBack() {});\r\n\r\nfunction makeArray(val) {\r\n    return new sqlArray(val);\r\n}\r\n"],[0,"\r\nfu"]],"start1":536,"start2":536,"length1":141,"length2":8},{"diffs":[[0,"slice = "],[-1,"sql"],[0,"Array.pr"]],"start1":577,"start2":577,"length1":19,"length2":16},{"diffs":[[0,"nIteration, "],[-1,"makeArray()"],[1,"[]"],[0,", array)\r\n}\r"]],"start1":1134,"start2":1134,"length1":35,"length2":26},{"diffs":[[0,"ration, "],[-1,"makeArray()"],[1,"[]"],[0,", array)"]],"start1":1415,"start2":1415,"length1":27,"length2":18},{"diffs":[[0,"\r\n\r\n"],[-1,"sqlArray.prototype._where ="],[1,"Object.defineProperties(Array.prototype, {\r\n  '_where': { value:  "],[0," fun"]],"start1":1436,"start2":1436,"length1":35,"length2":74},{"diffs":[[0,"); }"],[-1,"\r\nsqlArray.prototype._select ="],[1," }, \r\n  '_select': { value:"],[0," fun"]],"start1":1548,"start2":1548,"length1":38,"length2":35},{"diffs":[[0,"this); }"],[1," }\r\n})"],[0,"\r\n\r\nfunc"]],"start1":1614,"start2":1614,"length1":16,"length2":22},{"diffs":[[0,"    var "],[-1,"arra"],[1,"quer"],[0,"y = this"]],"start1":1653,"start2":1653,"length1":20,"length2":20},{"diffs":[[0," this;\r\n"],[1,"    \r\n"],[0,"    var "]],"start1":1668,"start2":1668,"length1":16,"length2":22},{"diffs":[[0,"ts, "],[-1,"0"],[1,"1"],[0,");\r\n    "],[-1,"var cols = makeArray()"],[1,"query.columns = query.columns || []"],[0,";\r\n "]],"start1":1755,"start2":1755,"length1":39,"length2":52},{"diffs":[[0,"    "],[-1,"cols.push(array._select(function(val) { return val[argumentValue]; }));\r\n    });\r\n    var ret = makeArray();\r\n    if(cols.length === args.length && cols.length > 0) {\r\n        var col = cols[0];\r\n        \r\n        for(var r=0; r < col.length; r += 1) {\r\n            var thisRow = ret[r] || {};\r\n            for(var c=0; c < cols.length; c +"],[1,"query.columns.push(argumentValue);\r\n    });\r\n    return query;\r\n    \r\n}\r\n\r\nfunction run() {\r\n    var query = this;\r\n    var ret = [];\r\n    if(query.columns.length > 0) {\r\n        var results =[];\r\n         each(query.columns, function(columnName) {\r\n             if (columnName) {\r\n                 each(query.tables, function(tbl) {\r\n                     if (Array.isArray(tbl)) {\r\n                         var res = {};\r\n                         var val = tbl._select(function(val) {\r\n                             return val[columnName];\r\n                         });\r\n                         if (val) {\r\n                             res[columnName] = val;\r\n                             results.push(res);\r\n                         }\r\n                     }\r\n                 }, true);\r\n             }\r\n         });\r\n        \r\n        each(results, function(val, key) {\r\n            var returnRow = {};\r\n            each(results, function(value, columnName) {\r\n                if(key == columnName && query.columns.indexOf(columnName) !="],[0,"= "],[1,"-"],[0,"1) {"]],"start1":1852,"start2":1852,"length1":350,"length2":1051},{"diffs":[[0,"    "],[1,"    "],[-1,"thisRow[args[c]] = cols[c][r];\r\n            }\r\n"],[1,"returnRow[columnName] = val;\r\n                }\r\n            }, true);\r\n            if(Object.keys(returnRow).length > 0) {\r\n    "],[0,"    "]],"start1":2917,"start2":2917,"length1":55,"length2":141},{"diffs":[[0,"et.push("],[-1,"this"],[1,"return"],[0,"Row);\r\n "]],"start1":3067,"start2":3067,"length1":20,"length2":22},{"diffs":[[0,"    "],[1,"   "],[1," "],[0,"}\r\n    "],[1,"   "],[-1,"}"],[1," }, true);"],[0,"\r\n    "],[1,"}"],[0,"\r\n  "]],"start1":3092,"start2":3092,"length1":22,"length2":39},{"diffs":[[0,"n re"],[-1,"t;\r\n    "],[1,"sults;\r\n}"],[0,"\r\n"],[-1,"}"],[0,"\r\n"],[-1,"sqlArray.prototype.select = select;\r\n\r\nfunction from(array) {\r\n    return "],[1,"Object.defineProperties(Array.prototype, {\r\n  'select': { value: select }, \r\n});\r\n\r\nfunction from(array) {\r\n    var query = this;\r\n    query.tables.push("],[0,"array"],[1,")"],[0,";\r\n"],[-1,"}"],[1,"    return query;"],[0,"\r\n"],[1,"}"],[0,"\r\n\r\nvar "],[-1,"peoples = makeA"],[1,"query = function(a"],[0,"rray"],[-1,"(["],[1,") {"],[0,"\r\n   "],[-1," { FirstName : \"John\", LastName : \"Doe\", Age : 29 },\r\n    { FirstName : \"Jane\", LastName : \"Doe\", Age : 33 },\r\n    { FirstName : \"Mary\", LastName : \"White\", Age : 31 },\r\n    { FirstName : \"Barry\", LastName : \"White\", Age : 31 },\r\n    { FirstName : \"Kevin\", LastName : \"Black\", Age : 31 },\r\n    { FirstName : \"Anna\", LastName : \"Smith\", Age : 1"],[1,"var tables = [];\r\n   tables.push(array);\r\n   var _query = {\r\n       tables: tables,\r\n       from: curryLeft(from, _query),\r\n       select: curryLeft(select, _query),\r\n       run: curryLeft(run, _query)       \r\n  "],[0," }"],[1,";"],[0,"\r\n   "],[-1," \r\n])"],[1,"return _query;\r\n}"],[0,";\r\n\r"]],"start1":3138,"start2":3138,"length1":495,"length2":478}]],"length":3617,"saved":false}
